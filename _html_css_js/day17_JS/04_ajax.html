<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>
        *비동기 통신(asynchronous communication) : AJAX
    </h1>
    <ul>
        <li>
            데이터 통신 방식 : 1. 동기  /  2. 비동기
        </li>
        <li>
            1. 동기(synchronous) 방식
                : 동시에 일어나는 요청을 하면, 바로 응답을 받는다는 의미(순서적임)
                    *<form action="">동기방식</form>
                    > 동기방식으로 요청하면, 페이지로 리턴
        </li>
        <li>
            2. 비동기(asynchronous) 방식
                : 동시에 일어나지 않는 요청(순서적이지 않음)
                : 그 자리에서 결과가 바로 주어지지 않을 수 있다.
        </li>
        <li>
            동기와 비동기의 장단점
        </li>
        <li>
            동기 방식 : 직관적이며, 설계가 간단
                단, 결과가 주어지기 전까지는 아무것도 못하고 대기해야 하는 것이 단점(ex. input > type value 등 설정하여 처리하는 것 등등)
        </li>
        <li>
            *비동기 방식 : 설계가 복잡
                단, 결과가 주어지는데까지 시간이 결려도, 다른 작업을 할 수 있어 효율적이다.
        </li>
        <li>
            AJAX jquery (라이브러리)        *참고 : https://amy-it.tistory.com/96 / 현재는 바닐라스크립트 선호?
        </li>
    </ul>
        <ul>
            <li>
                async await : 비동기 통신 키워드
                    > Promise 객체를 이용하여 데이터 통신을 편리하게 할수 있도록 제공되는 키워드(비동기 통신 시 Promise 객체를 리턴)
            </li>
            <li>
                async 키워드 : 함수 선언 앞에 붙이는 키워드 (ex. async function)
                    > 그 함수의 리턴 타입이 Promise 객체 타입으로 리턴된다.
            </li>
            <li>
                await 키워드 : 순차적으로 코드가 실행되어야 할 때 사용
                    > 순차 코드 실행 시 지연로딩, 지연실행 상황이 발생하면, 코드실행을 순차적으로 진행할 수 있도록 보증
                    즉, 이전 라인의 코드 실행이 완료될 때까지 다음 라인은 기다릴 수 있도록 하는 기능
            </li>
            <li>
                http://jsonplaceholder.typicode.com/
            </li>
        
        </ul>

    <h3>async await 연습</h3>
    <button type="button" id="btn">데이터 불러오기</button>
    <ul id="ul"></ul>

    <script>
        document.getElementById('btn').addEventListener('click',()=>{
            // asyncFun().then(result => console.log(result));                                         // then > promise코드를 처리하기 위한 방식(필수적으로 사용해야 한다.)
            asyncFun().then(result => printData(result));
        })
        async function asyncFun(){
            try {
                const resp = await fetch('http://jsonplaceholder.typicode.com/todos/1')             // response
                const result = await resp.json();       // body에 실어준 값을 json()형태로 리턴
                console.log(resp);
                console.log(typeof resp);
                console.log(result);
                console.log(typeof result);
                return result;
            } catch (error) {
                console.log(error);
            } finally{
                console.log('await finish');
            }
        }

        // *참고 : status code > https://www.whatap.io/ko/blog/40/


        function printData(obj){
            console.log(obj);
            let ul = document.getElementById('ul');
            for(const key in obj){
                ul.innerHTML += `<li>${key} : ${obj[key]}</li>`;
            };
        }


    </script>    
    
</body>
</html>